//==================================================================================================
//Version 1.0, auto-generated.
//Generated By huangzf.
//Date: 2013-1-24 10:33:04.
//==================================================================================================
//==================================================================================================
//This file is generated by CodeGenerator(Ver 2.1), a product of ZhouYonghua(Zhou_Yonghua@163.com).
//==================================================================================================

using System;
using System.Data;

using System.Data.SqlClient;
using ETMS.Utility.Data;

namespace ETMS.Components.QS.Implement.DAL
{
    /// <summary>
    /// 用户作答结果表数据访问
    /// </summary>
    public partial class QS_QueryResultDataAccess
    {


        /// <summary>
        /// 查询某个用户的某个问卷调查结果
        /// </summary>
        /// <param name="userID">用户ID</param>
        /// <param name="queryID">问卷调查ID</param>
        /// <returns>返回三个表.依次是:用户作答结果表QS_QueryResult,问答题作答结果表QS_QueryResultAnswer,选择题作答结果表QS_QueryResultOption</returns>
        public DataSet GetResultByUserIDQueryID(int userID, Guid queryID)
        {
            DataSet ds = new DataSet();

            string commandName = "dbo.[Pr_QS_QueryResult_GetResultByUserIDQueryID]";
            #region Parameters
            SqlParameter[] parms = SqlHelperParameterCache.GetCachedParameterSet(ConnectionString.ETMSRead, commandName);
            if (parms == null)
            {
                parms = new SqlParameter[] {
					new SqlParameter("@UserID", SqlDbType.Int),
					new SqlParameter("@QueryID", SqlDbType.UniqueIdentifier)
				};
                SqlHelperParameterCache.CacheParameterSet(ConnectionString.ETMSRead, commandName, parms);
            }

            parms[0].Value = userID;
            parms[1].Value = queryID;
            #endregion
            ds = SqlHelper.ExecuteDataset(ConnectionString.ETMSRead, CommandType.StoredProcedure, commandName, parms);
            return ds;
        }


    }
}
